apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: a5-cerebros-wine-2-input-class-
  annotations: {pipelines.kubeflow.org/kfp_sdk_version: 1.7.post0+41.gb3589b6c6, pipelines.kubeflow.org/pipeline_compilation_time: '2022-11-04T04:38:20.344588',
    pipelines.kubeflow.org/pipeline_spec: '{"description": "Cerebros wine 2 input
      classifier test.", "inputs": [{"default": "relu", "name": "activation", "optional":
      true, "type": "String"}, {"default": "2.0", "name": "predecessor_level_connection_affinity_factor_first",
      "optional": true, "type": "Float"}, {"default": "0.97", "name": "predecessor_level_connection_affinity_factor_main",
      "optional": true, "type": "Float"}, {"default": "5", "name": "max_consecutive_lateral_connections",
      "optional": true, "type": "Integer"}, {"default": "0.97", "name": "p_lateral_connection",
      "optional": true, "type": "Float"}, {"default": "2", "name": "num_lateral_connection_tries_per_unit",
      "optional": true, "type": "Integer"}, {"default": "0.001", "name": "learning_rate",
      "optional": true, "type": "Float"}, {"default": "10", "name": "epochs", "optional":
      true, "type": "Integer"}, {"default": "100", "name": "batch_size", "optional":
      true, "type": "Integer"}, {"default": "http://rok.rok.svc.cluster.local/swift/v1/kubeflow-user/notebooks/cerebros-wine-pipeline-0_cerebros-wine-pipeline-workspace-th5gf?version=bf3ac460-ecef-4001-94b7-628d63e239f0",
      "name": "rok_cerebros_wine_pipeline_workspace_th5gf_url", "optional": true,
      "type": "String"}, {"default": "http://rok.rok.svc.cluster.local/swift/v1/kubeflow-user/notebooks/cerebros-wine-pipeline-0_cerebros-wine-pipeline-datavol-1-s4w29?version=c8146a89-8f1d-48a8-997d-d93a15702913",
      "name": "rok_cerebros_wine_pipeline_datavol_1_s4w29_url", "optional": true,
      "type": "String"}], "name": "a5-cerebros-wine-2-input-class"}'}
  labels: {pipelines.kubeflow.org/kfp_sdk_version: 1.7.post0.41.gb3589b6c6}
spec:
  entrypoint: a5-cerebros-wine-2-input-class
  templates:
  - name: a5-cerebros-wine-2-input-class
    inputs:
      parameters:
      - {name: activation}
      - {name: batch_size}
      - {name: epochs}
      - {name: learning_rate}
      - {name: max_consecutive_lateral_connections}
      - {name: num_lateral_connection_tries_per_unit}
      - {name: p_lateral_connection}
      - {name: predecessor_level_connection_affinity_factor_first}
      - {name: predecessor_level_connection_affinity_factor_main}
      - {name: rok_cerebros_wine_pipeline_datavol_1_s4w29_url}
      - {name: rok_cerebros_wine_pipeline_workspace_th5gf_url}
    dag:
      tasks:
      - name: create-volume-1
        template: create-volume-1
        arguments:
          parameters:
          - {name: rok_cerebros_wine_pipeline_workspace_th5gf_url, value: '{{inputs.parameters.rok_cerebros_wine_pipeline_workspace_th5gf_url}}'}
      - name: create-volume-2
        template: create-volume-2
        arguments:
          parameters:
          - {name: rok_cerebros_wine_pipeline_datavol_1_s4w29_url, value: '{{inputs.parameters.rok_cerebros_wine_pipeline_datavol_1_s4w29_url}}'}
      - name: preprocessdata
        template: preprocessdata
        dependencies: [create-volume-1, create-volume-2]
        arguments:
          parameters:
          - {name: create-volume-1-name, value: '{{tasks.create-volume-1.outputs.parameters.create-volume-1-name}}'}
          - {name: create-volume-2-name, value: '{{tasks.create-volume-2.outputs.parameters.create-volume-2-name}}'}
      - name: train
        template: train
        dependencies: [create-volume-1, create-volume-2, preprocessdata]
        arguments:
          parameters:
          - {name: activation, value: '{{inputs.parameters.activation}}'}
          - {name: batch_size, value: '{{inputs.parameters.batch_size}}'}
          - {name: create-volume-1-name, value: '{{tasks.create-volume-1.outputs.parameters.create-volume-1-name}}'}
          - {name: create-volume-2-name, value: '{{tasks.create-volume-2.outputs.parameters.create-volume-2-name}}'}
          - {name: epochs, value: '{{inputs.parameters.epochs}}'}
          - {name: learning_rate, value: '{{inputs.parameters.learning_rate}}'}
          - {name: max_consecutive_lateral_connections, value: '{{inputs.parameters.max_consecutive_lateral_connections}}'}
          - {name: num_lateral_connection_tries_per_unit, value: '{{inputs.parameters.num_lateral_connection_tries_per_unit}}'}
          - {name: p_lateral_connection, value: '{{inputs.parameters.p_lateral_connection}}'}
          - {name: predecessor_level_connection_affinity_factor_first, value: '{{inputs.parameters.predecessor_level_connection_affinity_factor_first}}'}
          - {name: predecessor_level_connection_affinity_factor_main, value: '{{inputs.parameters.predecessor_level_connection_affinity_factor_main}}'}
          - {name: preprocessdata-INPUT_SHAPES, value: '{{tasks.preprocessdata.outputs.parameters.preprocessdata-INPUT_SHAPES}}'}
          - {name: preprocessdata-OUTPUT_SHAPES, value: '{{tasks.preprocessdata.outputs.parameters.preprocessdata-OUTPUT_SHAPES}}'}
          - {name: preprocessdata-PROJECT_NAME, value: '{{tasks.preprocessdata.outputs.parameters.preprocessdata-PROJECT_NAME}}'}
          - {name: preprocessdata-train_labels, value: '{{tasks.preprocessdata.outputs.parameters.preprocessdata-train_labels}}'}
          - {name: preprocessdata-training_x, value: '{{tasks.preprocessdata.outputs.parameters.preprocessdata-training_x}}'}
  - name: create-volume-1
    resource:
      action: create
      setOwnerReference: true
      manifest: |
        apiVersion: v1
        kind: PersistentVolumeClaim
        metadata:
          annotations:
            rok/origin: '{{inputs.parameters.rok_cerebros_wine_pipeline_workspace_th5gf_url}}'
          name: '{{workflow.name}}-cerebros-wine-pipeline-workspace-th5gf'
        spec:
          accessModes:
          - ReadWriteMany
          resources:
            requests:
              storage: 5Gi
          storageClassName: rok
    inputs:
      parameters:
      - {name: rok_cerebros_wine_pipeline_workspace_th5gf_url}
    outputs:
      parameters:
      - name: create-volume-1-manifest
        valueFrom: {jsonPath: '{}'}
      - name: create-volume-1-name
        valueFrom: {jsonPath: '{.metadata.name}'}
      - name: create-volume-1-size
        valueFrom: {jsonPath: '{.status.capacity.storage}'}
    metadata:
      annotations: {pipelines.kubeflow.org/max_cache_staleness: P0D}
      labels:
        pipelines.kubeflow.org/cache_enabled: "false"
        pipelines.kubeflow.org/enable_caching: "true"
  - name: create-volume-2
    resource:
      action: create
      setOwnerReference: true
      manifest: |
        apiVersion: v1
        kind: PersistentVolumeClaim
        metadata:
          annotations:
            rok/origin: '{{inputs.parameters.rok_cerebros_wine_pipeline_datavol_1_s4w29_url}}'
          name: '{{workflow.name}}-cerebros-wine-pipeline-datavol-1-s4w29'
        spec:
          accessModes:
          - ReadWriteMany
          resources:
            requests:
              storage: 5Gi
          storageClassName: rok
    inputs:
      parameters:
      - {name: rok_cerebros_wine_pipeline_datavol_1_s4w29_url}
    outputs:
      parameters:
      - name: create-volume-2-manifest
        valueFrom: {jsonPath: '{}'}
      - name: create-volume-2-name
        valueFrom: {jsonPath: '{.metadata.name}'}
      - name: create-volume-2-size
        valueFrom: {jsonPath: '{.status.capacity.storage}'}
    metadata:
      annotations: {pipelines.kubeflow.org/max_cache_staleness: P0D}
      labels:
        pipelines.kubeflow.org/cache_enabled: "false"
        pipelines.kubeflow.org/enable_caching: "true"
  - name: preprocessdata
    container:
      args: [--out, INPUT_SHAPES, /tmp/outputs/INPUT_SHAPES/data, --out, PROJECT_NAME,
        /tmp/outputs/PROJECT_NAME/data, --out, train_labels, /tmp/outputs/train_labels/data,
        --out, OUTPUT_SHAPES, /tmp/outputs/OUTPUT_SHAPES/data, --out, training_x,
        /tmp/outputs/training_x/data]
      command: [python3, -u, -m, kale, /home/jovyan/cerebros-dev/a-2022-11-03--21-10-cerebros-wine-2-input-classification-dataset.ipynb,
        --step, preprocessdata]
      env:
      - {name: PYTHONUNBUFFERED, value: '1'}
      image: gcr.io/arrikto/jupyter-kale-py38@sha256:5077b32dcbb88b4f9a77b044df2f7d0cf48a3e24932af412b017fca6dff64aaa
      securityContext: {runAsUser: 0}
      volumeMounts:
      - {mountPath: /home/jovyan, name: create-volume-1}
      - {mountPath: /home/jovyan/cerebros-wine-pipeline-datavol-1, name: create-volume-2}
      workingDir: /home/jovyan/cerebros-dev
    inputs:
      parameters:
      - {name: create-volume-1-name}
      - {name: create-volume-2-name}
    outputs:
      parameters:
      - name: preprocessdata-INPUT_SHAPES
        valueFrom: {path: /tmp/outputs/INPUT_SHAPES/data}
      - name: preprocessdata-OUTPUT_SHAPES
        valueFrom: {path: /tmp/outputs/OUTPUT_SHAPES/data}
      - name: preprocessdata-PROJECT_NAME
        valueFrom: {path: /tmp/outputs/PROJECT_NAME/data}
      - name: preprocessdata-train_labels
        valueFrom: {path: /tmp/outputs/train_labels/data}
      - name: preprocessdata-training_x
        valueFrom: {path: /tmp/outputs/training_x/data}
      artifacts:
      - {name: mlpipeline-ui-metadata, path: /tmp/mlpipeline-ui-metadata.json}
      - {name: preprocessdata, path: /tmp/preprocessdata.html}
      - {name: preprocessdata-INPUT_SHAPES, path: /tmp/outputs/INPUT_SHAPES/data}
      - {name: preprocessdata-OUTPUT_SHAPES, path: /tmp/outputs/OUTPUT_SHAPES/data}
      - {name: preprocessdata-PROJECT_NAME, path: /tmp/outputs/PROJECT_NAME/data}
      - {name: preprocessdata-train_labels, path: /tmp/outputs/train_labels/data}
      - {name: preprocessdata-training_x, path: /tmp/outputs/training_x/data}
    metadata:
      annotations: {kubeflow-kale.org/dependent-templates: '["create-volume-1", "create-volume-2"]',
        pipelines.kubeflow.org/max_cache_staleness: P0D, kubeflow-kale.org/volume-name-parameters: '["create-volume-1-name",
          "create-volume-2-name"]', pipelines.kubeflow.org/component_spec: '{"description":
          "", "implementation": {"container": {"args": ["--out", "INPUT_SHAPES", {"outputPath":
          "INPUT_SHAPES"}, "--out", "PROJECT_NAME", {"outputPath": "PROJECT_NAME"},
          "--out", "train_labels", {"outputPath": "train_labels"}, "--out", "OUTPUT_SHAPES",
          {"outputPath": "OUTPUT_SHAPES"}, "--out", "training_x", {"outputPath": "training_x"}],
          "command": ["python3", "-u", "-m", "kale", "/home/jovyan/cerebros-dev/a-2022-11-03--21-10-cerebros-wine-2-input-classification-dataset.ipynb",
          "--step", "preprocessdata"], "env": {"PYTHONUNBUFFERED": "1"}, "image":
          "gcr.io/arrikto/jupyter-kale-py38@sha256:5077b32dcbb88b4f9a77b044df2f7d0cf48a3e24932af412b017fca6dff64aaa"}},
          "inputs": [], "name": "preprocessdata", "outputs": [{"name": "INPUT_SHAPES",
          "type": "KaleMarshalData"}, {"name": "PROJECT_NAME", "type": "KaleMarshalData"},
          {"name": "train_labels", "type": "KaleMarshalData"}, {"name": "OUTPUT_SHAPES",
          "type": "KaleMarshalData"}, {"name": "training_x", "type": "KaleMarshalData"}]}',
        pipelines.kubeflow.org/component_ref: '{"name": "a5-cerebros-wine-2-input-class"}'}
      labels:
        access-ml-pipeline: "true"
        access-rok: "true"
        pipelines.kubeflow.org/metadata_written: "true"
        pipelines.kubeflow.org/cache_enabled: "false"
        pipelines.kubeflow.org/enable_caching: "true"
    volumes:
    - name: create-volume-1
      persistentVolumeClaim: {claimName: '{{inputs.parameters.create-volume-1-name}}'}
    - name: create-volume-2
      persistentVolumeClaim: {claimName: '{{inputs.parameters.create-volume-2-name}}'}
  - name: train
    container:
      args: [--in, INPUT_SHAPES, '{{inputs.parameters.preprocessdata-INPUT_SHAPES}}',
        --in, PROJECT_NAME, '{{inputs.parameters.preprocessdata-PROJECT_NAME}}', --in,
        train_labels, '{{inputs.parameters.preprocessdata-train_labels}}', --in, OUTPUT_SHAPES,
        '{{inputs.parameters.preprocessdata-OUTPUT_SHAPES}}', --in, training_x, '{{inputs.parameters.preprocessdata-training_x}}',
        --in, p_lateral_connection, '{{inputs.parameters.p_lateral_connection}}',
        --in, num_lateral_connection_tries_per_unit, '{{inputs.parameters.num_lateral_connection_tries_per_unit}}',
        --in, predecessor_level_connection_affinity_factor_main, '{{inputs.parameters.predecessor_level_connection_affinity_factor_main}}',
        --in, learning_rate, '{{inputs.parameters.learning_rate}}', --in, epochs,
        '{{inputs.parameters.epochs}}', --in, batch_size, '{{inputs.parameters.batch_size}}',
        --in, max_consecutive_lateral_connections, '{{inputs.parameters.max_consecutive_lateral_connections}}',
        --in, activation, '{{inputs.parameters.activation}}', --in, predecessor_level_connection_affinity_factor_first,
        '{{inputs.parameters.predecessor_level_connection_affinity_factor_first}}']
      command: [python3, -u, -m, kale, /home/jovyan/cerebros-dev/a-2022-11-03--21-10-cerebros-wine-2-input-classification-dataset.ipynb,
        --step, train]
      env:
      - {name: PYTHONUNBUFFERED, value: '1'}
      image: gcr.io/arrikto/jupyter-kale-py38@sha256:5077b32dcbb88b4f9a77b044df2f7d0cf48a3e24932af412b017fca6dff64aaa
      securityContext: {runAsUser: 0}
      volumeMounts:
      - {mountPath: /home/jovyan, name: create-volume-1}
      - {mountPath: /home/jovyan/cerebros-wine-pipeline-datavol-1, name: create-volume-2}
      workingDir: /home/jovyan/cerebros-dev
    inputs:
      parameters:
      - {name: activation}
      - {name: batch_size}
      - {name: create-volume-1-name}
      - {name: create-volume-2-name}
      - {name: epochs}
      - {name: learning_rate}
      - {name: max_consecutive_lateral_connections}
      - {name: num_lateral_connection_tries_per_unit}
      - {name: p_lateral_connection}
      - {name: predecessor_level_connection_affinity_factor_first}
      - {name: predecessor_level_connection_affinity_factor_main}
      - {name: preprocessdata-INPUT_SHAPES}
      - {name: preprocessdata-OUTPUT_SHAPES}
      - {name: preprocessdata-PROJECT_NAME}
      - {name: preprocessdata-train_labels}
      - {name: preprocessdata-training_x}
    outputs:
      artifacts:
      - {name: mlpipeline-ui-metadata, path: /tmp/mlpipeline-ui-metadata.json}
      - {name: mlpipeline-metrics, path: /tmp/mlpipeline-metrics.json}
      - {name: train, path: /tmp/train.html}
    metadata:
      annotations: {kubeflow-kale.org/dependent-templates: '["create-volume-1", "create-volume-2",
          "preprocessdata"]', pipelines.kubeflow.org/max_cache_staleness: P0D, kubeflow-kale.org/volume-name-parameters: '["create-volume-1-name",
          "create-volume-2-name"]', pipelines.kubeflow.org/component_spec: '{"description":
          "", "implementation": {"container": {"args": ["--in", "INPUT_SHAPES", {"inputValue":
          "INPUT_SHAPES"}, "--in", "PROJECT_NAME", {"inputValue": "PROJECT_NAME"},
          "--in", "train_labels", {"inputValue": "train_labels"}, "--in", "OUTPUT_SHAPES",
          {"inputValue": "OUTPUT_SHAPES"}, "--in", "training_x", {"inputValue": "training_x"},
          "--in", "p_lateral_connection", {"inputValue": "p_lateral_connection"},
          "--in", "num_lateral_connection_tries_per_unit", {"inputValue": "num_lateral_connection_tries_per_unit"},
          "--in", "predecessor_level_connection_affinity_factor_main", {"inputValue":
          "predecessor_level_connection_affinity_factor_main"}, "--in", "learning_rate",
          {"inputValue": "learning_rate"}, "--in", "epochs", {"inputValue": "epochs"},
          "--in", "batch_size", {"inputValue": "batch_size"}, "--in", "max_consecutive_lateral_connections",
          {"inputValue": "max_consecutive_lateral_connections"}, "--in", "activation",
          {"inputValue": "activation"}, "--in", "predecessor_level_connection_affinity_factor_first",
          {"inputValue": "predecessor_level_connection_affinity_factor_first"}], "command":
          ["python3", "-u", "-m", "kale", "/home/jovyan/cerebros-dev/a-2022-11-03--21-10-cerebros-wine-2-input-classification-dataset.ipynb",
          "--step", "train"], "env": {"PYTHONUNBUFFERED": "1"}, "image": "gcr.io/arrikto/jupyter-kale-py38@sha256:5077b32dcbb88b4f9a77b044df2f7d0cf48a3e24932af412b017fca6dff64aaa"}},
          "inputs": [{"name": "INPUT_SHAPES", "type": "KaleMarshalData"}, {"name":
          "PROJECT_NAME", "type": "KaleMarshalData"}, {"name": "train_labels", "type":
          "KaleMarshalData"}, {"name": "OUTPUT_SHAPES", "type": "KaleMarshalData"},
          {"name": "training_x", "type": "KaleMarshalData"}, {"name": "p_lateral_connection",
          "type": "Float"}, {"name": "num_lateral_connection_tries_per_unit", "type":
          "Integer"}, {"name": "predecessor_level_connection_affinity_factor_main",
          "type": "Float"}, {"name": "learning_rate", "type": "Float"}, {"name": "epochs",
          "type": "Integer"}, {"name": "batch_size", "type": "Integer"}, {"name":
          "max_consecutive_lateral_connections", "type": "Integer"}, {"name": "activation",
          "type": "String"}, {"name": "predecessor_level_connection_affinity_factor_first",
          "type": "Float"}], "name": "train", "outputs": []}', pipelines.kubeflow.org/component_ref: '{"name":
          "a5-cerebros-wine-2-input-class"}', pipelines.kubeflow.org/arguments.parameters: '{"INPUT_SHAPES":
          "{{inputs.parameters.preprocessdata-INPUT_SHAPES}}", "OUTPUT_SHAPES": "{{inputs.parameters.preprocessdata-OUTPUT_SHAPES}}",
          "PROJECT_NAME": "{{inputs.parameters.preprocessdata-PROJECT_NAME}}", "activation":
          "{{inputs.parameters.activation}}", "batch_size": "{{inputs.parameters.batch_size}}",
          "epochs": "{{inputs.parameters.epochs}}", "learning_rate": "{{inputs.parameters.learning_rate}}",
          "max_consecutive_lateral_connections": "{{inputs.parameters.max_consecutive_lateral_connections}}",
          "num_lateral_connection_tries_per_unit": "{{inputs.parameters.num_lateral_connection_tries_per_unit}}",
          "p_lateral_connection": "{{inputs.parameters.p_lateral_connection}}", "predecessor_level_connection_affinity_factor_first":
          "{{inputs.parameters.predecessor_level_connection_affinity_factor_first}}",
          "predecessor_level_connection_affinity_factor_main": "{{inputs.parameters.predecessor_level_connection_affinity_factor_main}}",
          "train_labels": "{{inputs.parameters.preprocessdata-train_labels}}", "training_x":
          "{{inputs.parameters.preprocessdata-training_x}}"}'}
      labels:
        access-ml-pipeline: "true"
        access-rok: "true"
        pipelines.kubeflow.org/metadata_written: "true"
        pipelines.kubeflow.org/cache_enabled: "false"
        pipelines.kubeflow.org/enable_caching: "true"
    volumes:
    - name: create-volume-1
      persistentVolumeClaim: {claimName: '{{inputs.parameters.create-volume-1-name}}'}
    - name: create-volume-2
      persistentVolumeClaim: {claimName: '{{inputs.parameters.create-volume-2-name}}'}
  arguments:
    parameters:
    - {name: activation, value: relu}
    - {name: predecessor_level_connection_affinity_factor_first, value: '2.0'}
    - {name: predecessor_level_connection_affinity_factor_main, value: '0.97'}
    - {name: max_consecutive_lateral_connections, value: '5'}
    - {name: p_lateral_connection, value: '0.97'}
    - {name: num_lateral_connection_tries_per_unit, value: '2'}
    - {name: learning_rate, value: '0.001'}
    - {name: epochs, value: '10'}
    - {name: batch_size, value: '100'}
    - {name: rok_cerebros_wine_pipeline_workspace_th5gf_url, value: 'http://rok.rok.svc.cluster.local/swift/v1/kubeflow-user/notebooks/cerebros-wine-pipeline-0_cerebros-wine-pipeline-workspace-th5gf?version=bf3ac460-ecef-4001-94b7-628d63e239f0'}
    - {name: rok_cerebros_wine_pipeline_datavol_1_s4w29_url, value: 'http://rok.rok.svc.cluster.local/swift/v1/kubeflow-user/notebooks/cerebros-wine-pipeline-0_cerebros-wine-pipeline-datavol-1-s4w29?version=c8146a89-8f1d-48a8-997d-d93a15702913'}
  serviceAccountName: pipeline-runner
